(this["webpackJsonpcovid19-spa"]=this["webpackJsonpcovid19-spa"]||[]).push([[0],{199:function(e,t,n){e.exports=n(366)},361:function(e,t,n){},364:function(e,t,n){},366:function(e,t,n){"use strict";n.r(t);var a,r,o=n(0),c=n.n(o),s=n(26),i=n.n(s),u=n(99),d=n(92),l=n(39),f=n(73),p=n(182),b=n(59),v=n(43),g=Object(v.b)("user/login"),m=Object(v.b)("user/logout"),h=Object(v.b)("user/set-token"),y=Object(v.b)("user/set-loading"),x=Object(v.b)("user/signup"),O=n(94),j=n(196),k=Object(f.b)((function(e,t){var n=e.user.token;return Object(O.a)({},t,{isLoggedIn:!!n,token:n})}))((function(e){var t=e.isLoggedIn,n=(e.token,e.redirectTo),a=Object(j.a)(e,["isLoggedIn","token","redirectTo"]);return t?c.a.createElement(l.b,a):c.a.createElement(l.a,{to:n})})),w=n(118),E=n(371),S=n(369),I=n(65),L=n(368),A=n(372),C=n(373),D=n(374),R=Object(v.b)("covid/set-data"),B=Object(v.b)("covid/set-loading"),F=Object(v.b)("covid/load-from-api"),P=function(e){return e.toLocaleString()},T=[{dataIndex:"state",title:"Particulars",key:"state",fixed:"left",sorter:function(e,t){return e.state>t.state},defaultSortOrder:"ascend"},{dataIndex:"todayCases",title:"Total (today)",key:"cases-today",sorter:function(e,t){return e.todayCases-t.todayCases},responsive:["lg"],render:P},{dataIndex:"todayActive",title:"Active (today)",key:"active-today",sorter:function(e,t){return e.todayActive-t.todayActive},responsive:["lg"],render:P},{dataIndex:"todayDeaths",title:"Deaths (today)",key:"death-today",sorter:function(e,t){return e.todayDeaths-t.todayDeaths},responsive:["lg"],render:P},{dataIndex:"todayRecovered",title:"Recovered (today)",key:"recovered-today",sorter:function(e,t){return e.todayRecovered-t.todayRecovered},responsive:["lg"],render:P},{dataIndex:"cases",title:"Total",key:"cases-till",sorter:function(e,t){return e.cases-t.cases},render:P},{dataIndex:"active",title:"Active",key:"active-till",sorter:function(e,t){return e.active-t.active},responsive:["md"],render:P},{dataIndex:"deaths",title:"Deaths",key:"death-till",sorter:function(e,t){return e.deaths-t.deaths},render:P},{dataIndex:"recovered",title:"Recovered",key:"recovered-till",sorter:function(e,t){return e.recovered-t.recovered},render:P}],U=Object(f.b)((function(e){var t=e.covid,n=void 0===t?{}:t;return Object(O.a)({},n)}),(function(e){return{onRefresh:function(t){return e(F(t))},onLogout:function(t){return e(m(t))}}}))((function(e){var t=e.data,n=void 0===t?{}:t,a=e.loading,r=void 0!==a&&a,s=e.onRefresh,i=e.onLogout,u=Object(l.g)();Object(o.useEffect)((function(){p()}),[]);var d=function(e){E.b.error(e.message||"Logout failed")},f=function(){E.b.success("User logged out"),u.push("/login-signup")},p=function(){s({onFail:function(e){E.b.error(e.message)}})},b=(null===n||void 0===n?void 0:n.updated)?new Date(n.updated):"",v=(null===n||void 0===n?void 0:n.states)&&(null===n||void 0===n?void 0:n.total)?[].concat(Object(w.a)(n.states),[Object(O.a)({},n.total,{state:"Total (all states)"})]):[];return c.a.createElement(S.a,{loading:r,title:c.a.createElement("div",null,c.a.createElement("h2",null,"Data for covid-19 cases in India"),b&&c.a.createElement("h5",null,"(last-updated on ".concat(b.toLocaleDateString(),")"))),extra:[c.a.createElement(I.a,{size:"small",onClick:p,icon:c.a.createElement(C.a,null),disabled:r,"data-cy":"refresh",key:"refresh",title:"reload data",style:{marginRight:"10px"}}),c.a.createElement(I.a,{size:"small","data-cy":"logout",onClick:function(){i({onFail:d,onSuccess:f})},type:"primary",loading:r,icon:c.a.createElement(D.a,null),key:"logout",title:"logout"})]},c.a.createElement(L.a,{footer:function(){return c.a.createElement(A.a,{type:"info",message:c.a.createElement("div",{style:{textAlign:"center"}},"Data-source:"," ",c.a.createElement("a",{href:"https://disease.sh/v3/covid-19/gov/IN"},"disease.sh"))})},dataSource:v,columns:T,pagination:!1,rowKey:function(e){return e.state},bordered:!0}))})),N=n(370),W={onLogin:g,onSignup:x},z=Object(f.b)((function(e){return{loading:e.user.loading}}),W)((function(e){var t=e.onLogin,n=e.loading,a=e.onSignup,r=Object(o.useState)(""),s=Object(u.a)(r,2),i=s[0],d=s[1],f=Object(o.useState)(""),p=Object(u.a)(f,2),b=p[0],v=p[1],g=Object(l.g)(),m=function(e){E.b.error("Login failed: ".concat(e.message))},h=function(){E.b.success("User logged in"),g.push("/")},y=function(){E.b.success("User signed up. You may login!")},x=function(e){E.b.error(e.message||"Signup failed")};return c.a.createElement(S.a,{className:"login-section",title:"Please login",extra:[c.a.createElement(I.a,{onClick:function(){i&&b?a({username:i,password:b,onSuccess:y,onFail:x}):E.b.error("Login needs username and password")},key:"signup","data-cy":"signup",disabled:n},"Signup")],bodyStyle:{display:"grid",placeItems:"center"},style:{maxWidth:"50vw",minWidth:"300px"},bordered:!0,hoverable:!0},c.a.createElement(N.a,{"data-cy":"username",onChange:function(e){var t=e.target.value;d(t)},addonBefore:"Username",style:{marginBottom:"0.4rem"}}),c.a.createElement(N.a.Password,{"data-cy":"password",onChange:function(e){var t=e.target.value;v(t)},addonBefore:"Password",style:{marginBottom:"0.4rem"}}),c.a.createElement(I.a,{"data-cy":"login",type:"primary",loading:n,onClick:function(){i&&b?t({username:i,password:b,onFail:m,onSuccess:h}):E.b.error("Login needs username and password")}},"Login"))})),q=n(35),J=n.n(q),K=n(194),H=n(30),Q=function(e,t){return b.auth().signInWithEmailAndPassword(e,t).then((function(){return{data:{token:b.auth().currentUser.uid}}}))},Y=function(){return b.auth().signOut()},Z=function(e,t){return b.auth().createUserWithEmailAndPassword(e,t)},$=n(190),_=n.n($),G=function(){return _.a.get("https://disease.sh/v3/covid-19/gov/IN",{accept:"application/json"})},M=J.a.mark((function e(t){var n,a,r,o,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(H.c)(y(!0));case 3:return n=t.payload,a=n.username,r=n.password,o=n.onSuccess,e.next=6,Q(a,r);case 6:return c=e.sent,e.next=9,Object(H.c)(h(c.data.token));case 9:return e.next=11,Object(H.b)(o,c);case 11:e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(0),console.error("Sign-up error: ".concat(e.t0.message)),e.next=18,Object(H.b)(t.payload.onFail,e.t0);case 18:return e.prev=18,e.next=21,Object(H.c)(y(!1));case 21:return e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[0,13,18,22]])})),V=J.a.mark((function e(t){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(H.c)(y(!0));case 3:return e.next=5,Object(H.b)(Y);case 5:return e.next=7,Object(H.c)(h(""));case 7:return e.next=9,Object(H.b)(t.payload.onSuccess);case 9:e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Logout error: ".concat(e.t0.message)),e.next=16,Object(H.b)(t.payload.onFail);case 16:return e.prev=16,e.next=19,Object(H.c)(y(!1));case 19:return e.finish(16);case 20:case"end":return e.stop()}}),e,null,[[0,11,16,20]])})),X=J.a.mark((function e(t){var n,a,r,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(H.c)(y(!0));case 3:return n=t.payload,a=n.username,r=n.password,o=n.onSuccess,e.next=6,Z(a,r);case 6:return e.next=8,Object(H.b)(o);case 8:e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(0),console.error("Login-error: ".concat(e.t0.message)),e.next=15,Object(H.b)(t.payload.onFail,e.t0);case 15:return e.prev=15,e.next=18,Object(H.c)(y(!1));case 18:return e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[0,10,15,19]])})),ee=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.e)(g.toString(),M);case 2:case"end":return e.stop()}}),e)})),te=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.e)(m.toString(),V);case 2:case"end":return e.stop()}}),e)})),ne=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.e)(x.toString(),X);case 2:case"end":return e.stop()}}),e)})),ae=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.a)([ee(),te(),ne()]);case 2:case"end":return e.stop()}}),e)})),re=J.a.mark((function e(t){var n,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(H.d)((function(e){return e.user.token}));case 3:if(e.sent){e.next=6;break}throw new Error("User not authenticated!");case 6:return e.next=8,Object(H.c)(B(!0));case 8:return e.next=10,G();case 10:return n=e.sent,e.next=13,Object(H.c)(R(n.data));case 13:e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(0),console.error("Data-fetching-error: ".concat(e.t0.message)),!(null===(a=t.payload)||void 0===a?void 0:a.onFail)){e.next=21;break}return e.next=21,Object(H.b)(t.payload.onFail,e.t0);case 21:return e.prev=21,e.next=24,Object(H.c)(B(!1));case 24:return e.finish(21);case 25:case"end":return e.stop()}}),e,null,[[0,15,21,25]])})),oe=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.e)(F.toString(),re);case 2:case"end":return e.stop()}}),e)})),ce=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:case"end":return e.stop()}}),e)})),se=n(76),ie=Object(v.c)({name:"user",initialState:{token:null,loading:!1},extraReducers:(a={},Object(se.a)(a,h,(function(e,t){return e.token=t.payload,e})),Object(se.a)(a,y,(function(e,t){return e.loading=t.payload,e})),a)}),ue=Object(v.c)({name:"covid",initialState:{data:{},loading:!1},extraReducers:(r={},Object(se.a)(r,R,(function(e,t){return e.data=t.payload,e})),Object(se.a)(r,B,(function(e,t){return e.loading=t.payload,e})),r)}),de=Object(K.a)(),le=null,fe=function(){if(le)return le;le=Object(v.a)({reducer:{user:ie.reducer,covid:ue.reducer},middleware:[].concat(Object(w.a)(Object(v.d)({serializableCheck:{ignoredActions:[F.toString(),g.toString(),m.toString(),x.toString()]}})),[de]),devTools:!1});var e=J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.a)([ae(),ce()]);case 2:case"end":return e.stop()}}),e)}));return de.run(e),le.destroy=function(){le=null},le},pe=(n(361),fe());var be=function(){var e=Object(o.useState)(!0),t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){var e=b.auth().onAuthStateChanged((function(n){var r;pe.dispatch(h(null!==(r=null===n||void 0===n?void 0:n.uid)&&void 0!==r?r:null)),clearTimeout(t),e(),a(!1)})),t=setTimeout((function(){a(!1),e()}),5e3)}),[]),Object(o.useEffect)((function(){return function(){pe.destroy()}}),[]),n?c.a.createElement("div",{className:"app"},c.a.createElement(p.a,null)):c.a.createElement(d.a,{basename:"/covid19"},c.a.createElement(f.a,{store:pe},c.a.createElement("div",{className:"app"},c.a.createElement(l.d,null,c.a.createElement(l.b,{exact:!0,path:"/login-signup",component:z}),c.a.createElement(k,{exact:!0,redirectTo:"/login-signup",path:"/",component:U}),c.a.createElement(l.a,{to:"/"})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(362),n(364),n(365);b.initializeApp({apiKey:"AIzaSyBrr5dysZ0APQxOniuBjeI_q9sesqHi7oU",authDomain:"covid19-efda1.firebaseapp.com",databaseURL:"https://covid19-efda1.firebaseio.com",projectId:"covid19-efda1",storageBucket:"covid19-efda1.appspot.com",messagingSenderId:"386904710490",appId:"1:386904710490:web:44e36f06f3ad642f75e763"}),b.auth().setPersistence(b.auth.Auth.Persistence.SESSION),i.a.render(c.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[199,1,2]]]);
//# sourceMappingURL=main.35983bd5.chunk.js.map